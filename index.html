<!DOCTYPE>
<html lang="fr">
<html>
    <head>
    <meta charset="utf-8">
     <title>Example jointJS</title>
     <link rel="stylesheet" href="css/joint.min.css">
     <script src="js/jquery-3.2.0.min.js"></script>    
     <script src="js/index.js"></script>
      <script src="js/backbone.js"></script>
     <script src="js/joint.min.js"></script>
    </head>

    <body>
        <h1>Figure 4</h1>
       <div id="fig4"></div>


  <script type="text/javascript">

  var graph = new joint.dia.Graph();
  var paper = new joint.dia.Paper({
    el: $('#fig4'),
    width: 800,
    height: 600,
    model: graph,
    gridSize: 1
 });

  var fig4 = new joint.shapes.devs.Model({
      position: { x: 50, y: 50 },
      size: { width: 600, height: 600 },
      inPorts: ['in:Job','done'],
      outPorts: ['out'],
      ports: {
          groups: {
              'in': {
                  attrs: {
                      '.port-body': {
                          fill: '#16A085'
                      }
                  }
              },
              'out': {
                  attrs: {
                      '.port-body': {
                          fill: '#E74C3C'
                      }
                  }
              }
          }
      },
      attrs: {
          '.label': { text: 'ADBuffer', 'ref-x': .5, 'ref-y': .2 },
          rect: { fill: '#A6EAE1' }
      }


  });


  var figWait = new joint.shapes.devs.Model({
      position: { x: 50, y: 50 },
      size: { width: 100, height: 100 },
      inPorts:['in'],
      outPorts:['out1','out2'],
      ports: {
          groups: {
              'in': {
                  attrs: {
                      '.port-body': {
                          fill: '#16A085'
                      }
                  }
              },
              'out': {
                  attrs: {
                      '.port-body': {
                          fill: '#E74C3C'
                      }
                  }
              }
          }
      },
      attrs: {
          '.label': { text: 'Wait', 'ref-x': .5, 'ref-y': .2 },
          rect: { fill: '#BCC9C8' }
      }
  });
  var figSend = new joint.shapes.devs.Model({
      position: { x: 50, y: 50 },
      size: { width: 100, height: 100 },
      inPorts:['in'],
      outPorts:['out1'],
      ports: {
          groups: {
              'in': {
                  attrs: {
                      '.port-body': {
                          fill: '#16A085'
                      }
                  }
              },
              'out': {
                  attrs: {
                      '.port-body': {
                          fill: '#E74C3C'
                      }
                  }
              }
          }
      },
      attrs: {
          '.label': { text: 'Send', 'ref-x': .5, 'ref-y': .2 },
          rect: { fill: '#BCC9C8' }
      }
  });

  var l1 = new joint.dia.Link({
      source: { id: figWait.id },
      target: { id: figSend.id },
      attrs: {
          '.marker-source': { fill: '#4b4a67', stroke: '#4b4a67', d: 'M 10 0 L 0 5 L 10 10 z' },
          '.marker-target': { fill: '#4b4a67', stroke: '#4b4a67', d: 'M 10 0 L 0 5 L 10 10 z' }
      },
      labels: [
          { position: 0.5, attrs: { text: { text: 'in?v@[p=F]/{n++}', fill: '#f6f6f6', 'font-family': 'sans-serif' }, rect: { stroke: '#7c68fc', 'stroke-width': 20, rx: 5, ry: 5 } }}
      ]
  });
  var l2 = new joint.dia.Link({
      source: { id: figWait.id },
      target: { id: figSend.id },
      attrs: {
          '.marker-source': { fill: '#4b4a67', stroke: '#4b4a67', d: 'M 10 0 L 0 5 L 10 10 z' },
          '.marker-target': { fill: '#4b4a67', stroke: '#4b4a67', d: 'M 10 0 L 0 5 L 10 10 z' }
      },
      labels: [
          { position: 0.5, attrs: { text: { text: 'done?@[nâ‰ 0]/{p=F}', fill: '#f6f6f6', 'font-family': 'sans-serif' }, rect: { stroke: '#7c68fc', 'stroke-width': 20, rx: 5, ry: 5 } }}
      ]
  });
  var l3 = new joint.dia.Link({
      source: { id: figSend.id, port:'in' },
      target: { id: figSend.id, port:'out1'},
  });

  var l4 = new joint.dia.Link({
      source: { id: figWait.id, port:'in' },
      target: { id: figWait.id, port:'out1'},
  });

  var l5 = new joint.dia.Link({
      source: { id: figWait.id, port:'in' },
      target: { id: figWait.id, port:'out2'},
  });
  
  l3.label(0, { position: .10, attrs: {text: { text: 'in?v/{n++}', 'font-size': 14, 'font-family': 'san-serif' }}});
  l4.label(0, { position: .10, attrs: {text: { text: 'in?v@[p=B]/{n++}', 'font-size': 14, 'font-family': 'san-serif' }}});
  l5.label(0, { position: .10, attrs: {text: { text: 'done?@[n=0]/{p=F}', 'font-size': 14, 'font-family': 'san-serif' }}});
  fig4.embed(figWait,figSend);
  graph.addCell([fig4,figSend,figWait,l1,l2,l3,l4,l5]);




  </script>

 </body>
</html>