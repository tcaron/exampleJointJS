<!DOCTYPE>

<html lang="fr">
<html>
<head>
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<link rel="stylesheet" href="css/joint.min.css">

    <meta charset="utf-8">
    <title>Example jointJS</title>
    <link rel="stylesheet" href="css/joint.min.css">
    <script src="js/jquery-3.2.0.min.js"></script>
    <script src="js/index.js"></script>
    <script src="js/backbone.js"></script>
    <script src="js/joint.min.js"></script> </head>

</head>
<body>
<div id="myholder"></div>
<script type="text/javascript">

	var json = null;
    var graph = new joint.dia.Graph;

    var paper = new joint.dia.Paper({
        el: $('#myholder'),
        width: 1500,
        height: 500,
        model: graph,
        gridSize: 1
    });

	function Save(){

	json = JSON.stringify(graph);
		
	}
	
	function Load(){
	
	graph.fromJSON(JSON.parse(json));
	
	}
	   
	function Clear(){
	
	graph.clear();
	
	}
	
    function ClearFields() {

        document.getElementById("name_id").value = "";
        document.getElementById("parameter_1").value = "";
        document.getElementById("parameter_2").value = "";
    }

    function GetTextfieldName()
    {

        var name = document.getElementById('name_id').value;
        return name;

    }

    function GetParametersOne(){

        var parameter_1 = document.getElementById('parameter_1').value;
        return parameter_1;

    }

    function GetParametersTwo(){
	
        var parameter_2 = document.getElementById('parameter_2').value;
        return parameter_2;
		
    }

    function CreateEtat(){
        var uml = joint.shapes.uml;
        var states = {

            S1: new uml.State({
                position: { x:100  , y: 100 },
                size: { width: 200, height: 200 },
                name: GetTextfieldName(),
                events: [GetParametersOne(),GetParametersTwo()],
                attrs: {
                    '.uml-state-body': {
                        fill: 'rgba(48, 208, 198, 0.1)',
                        stroke: 'rgba(48, 208, 198, 0.5)',
                        'stroke-width': 1.5
                    },
                    '.uml-state-separator': {
                        stroke: 'rgba(48, 208, 198, 0.4)'
                    }
                }
            }),

        };

        _.each(states, function(c) { graph.addCell(c); });
		
    }

    function CreateLink(){
	
	var link = new joint.shapes.uml.Transition({
    source: { x: 10, y: 450 },
    target: { x: 350, y: 450 },
    attrs: {}
	});


	link.attr({
    '.connection': { stroke: '#222138' },
    '.marker-source': { fill: '#31d0c6', stroke: 'none', d: 'M 10 0 L 0 5 L 10 10 z' },
    '.marker-target': { fill: '#fe854f', stroke: '#7c68fc', d: 'M 10 0 L 0 5 L 10 10 z' }
	});

	graph.addCell([link])

    }


</script>
<FORM>
    Name : &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<input type="text" name="name" id="name_id"  /><br>
	<br>
    First parameter :&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <input type="text"  name="parameter1" id="parameter_1"  /><br>
	<br>
    Second parameter : <input type="text" name="parameter2" id="parameter_2"  /><br>
	<br>
    <input type="button" class="btn btn-lg btn-primary" value="add state" onclick="CreateEtat(),ClearFields()" />
    <input type="button" class="btn btn-lg btn-primary" value="add link " onclick="CreateLink()" />
	<input type="button" class="btn btn-lg btn-primary" value="Clear graph" onclick="Clear()" />
	<input type="button" class="btn btn-lg btn-primary" value="Save graph" onclick="Save()" />
	<input type="button" class="btn btn-lg btn-primary" value="Open graph" onclick="Load()" />
</FORM>

</body>
</html>
